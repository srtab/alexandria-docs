{% load i18n %}
{% load core_tags account %}

<nav class="navbar navbar-expand-md navbar-dark bg-primary sticky-top">

    <a class="navbar-brand" href="{% url 'homepage' %}"><i class="fa fa-sitemap fa-fw" aria-hidden="true"></i> Alexandria Docs</a>

    <button class="navbar-toggler navbar-toggler-right" type="button" data-toggle="collapse" data-target="#navbarContent" aria-controls="navbarContent" aria-expanded="false" aria-label="Toggle navigation">
        <span class="navbar-toggler-icon"></span>
    </button>

    <div class="collapse navbar-collapse" id="navbarContent">

        {% is_current_url url_name='homepage' as is_homepage %}
        {% is_current_url namespace='search' url_name='index' as is_search %}

        {% if not is_homepage and not is_search %}
            <form action="{% url 'search:index' %}" class="form-inline ml-auto form-search">
                <input class="form-control form-control-sm mr-sm-2" type="text" placeholder="{% trans 'Search projects' %}" aria-label="{% trans 'Search projects' %}">
            </form>
        {% endif %}

        <ul class="navbar-nav {% if is_homepage or is_search %}ml-auto{% endif %}">
            {% if not user.is_authenticated %}
                <li class="nav-item {% menu_active url_name='account_login' %}">
                    <a class="nav-link" href="{% url 'account_login' %}">{% trans "Login" %}</a>
                </li>
            {% else %}
                <li class="nav-item dropdown dropdown-profile">
                    <a href="#" class="nav-link dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                        <i class="fa fa-user-circle-o fa-fw" aria-hidden="true"></i>
                    </a>
                    <div class="dropdown-menu dropdown-menu-right" aria-labelledby="navbarDropdownMenuLink">
                        <h6 class="dropdown-header">{% trans "Signed in as" %} <strong>{% user_display user %}</strong></h6>
                        <div class="dropdown-divider"></div>
                        {% if user.is_staff %}
                            <a class="dropdown-item" href="{% url 'admin:index' %}">{% trans "Administration" %}</a>
                        {% endif %}
                        <a class="dropdown-item" href="{% url 'accounts:index' user.slug %}">{% trans "Profile" %}</a>
                        <a class="dropdown-item" href="{% url 'account_email' %}">{% trans "Manage emails" %}</a>
                        <a class="dropdown-item" href="{% url 'socialaccount_connections' %}">{% trans "Social login" %}</a>
                        <a class="dropdown-item" href="{% url 'account_change_password' %}">{% trans "Change password" %}</a>
                        <div class="dropdown-divider"></div>
                        <a class="dropdown-item" href="{% url 'account_logout' %}">{% trans "Logout" %}</a>
                    </div>
                </li>
            {% endif %}
        </ul>

    </div>
</nav>
